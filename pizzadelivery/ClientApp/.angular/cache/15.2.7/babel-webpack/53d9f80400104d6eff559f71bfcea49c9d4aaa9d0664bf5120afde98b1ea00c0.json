{"ast":null,"code":"import * as _ from 'lodash';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nfunction HomeComponent_th_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 5);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const s_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", s_r5.Name, \" ($\", s_r5.Amount, \") \");\n  }\n}\nfunction HomeComponent_ng_container_14_tr_4_th_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 13)(1, \"div\", 14);\n    i0.ɵɵelement(2, \"input\", 15)(3, \"label\", 16);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const s_r10 = ctx.$implicit;\n    const v_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"id\", v_r8.name.replace(\" \", \"-\") + \"-\" + s_r10.Name.replace(\" \", \"-\"));\n    i0.ɵɵattribute(\"data-topping\", v_r8.name)(\"data-size\", s_r10.Name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"for\", v_r8.name.replace(\" \", \"-\") + \"-\" + s_r10.Name.replace(\" \", \"-\"));\n  }\n}\nfunction HomeComponent_ng_container_14_tr_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 13);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, HomeComponent_ng_container_14_tr_4_th_3_Template, 4, 4, \"th\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const v_r8 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", v_r8.name, \" ($\", v_r8.amount, \")\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.Sizes);\n  }\n}\nfunction HomeComponent_ng_container_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\")(2, \"th\", 12);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, HomeComponent_ng_container_14_tr_4_Template, 4, 3, \"tr\", 7);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const s_r6 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"colspan\", 1 + ctx_r1.Sizes.length);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", s_r6.key, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.getToppings(s_r6.key));\n  }\n}\nfunction HomeComponent_th_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"th\", 13)(1, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function HomeComponent_th_18_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const s_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.addCart(s_r12));\n    });\n    i0.ɵɵtext(2, \"Add Cart\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction HomeComponent_table_22_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 23)(1, \"td\")(2, \"p\", 24);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 24);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"a\", 25);\n    i0.ɵɵlistener(\"click\", function HomeComponent_table_22_tr_10_Template_a_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const i_r17 = restoredCtx.index;\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r18.removeItem(i_r17));\n    });\n    i0.ɵɵtext(7, \" remove \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const c_r16 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Size : \", c_r16.Size, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Toppings : \", c_r16.Toppings.join(\", \"), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", c_r16.Qty, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", c_r16.Amount, \" \");\n  }\n}\nfunction HomeComponent_table_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 2)(1, \"thead\", 3)(2, \"tr\")(3, \"th\", 12);\n    i0.ɵɵtext(4, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 18);\n    i0.ɵɵtext(6, \"Qty\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 19);\n    i0.ɵɵtext(8, \" Price\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"tbody\");\n    i0.ɵɵtemplate(10, HomeComponent_table_22_tr_10_Template, 12, 4, \"tr\", 20);\n    i0.ɵɵelementStart(11, \"tr\")(12, \"td\", 21);\n    i0.ɵɵtext(13, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\", 22);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.carts);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"$\", ctx_r3.total, \"\");\n  }\n}\nfunction HomeComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"span\");\n    i0.ɵɵtext(2, \" Empty Cart \");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class HomeComponent {\n  constructor() {\n    this.Toppings = [{\n      \"name\": \"Tomatoes\",\n      \"category\": \"Veg\",\n      \"amount\": 1.00\n    }, {\n      \"name\": \"Onions\",\n      \"category\": \"Veg\",\n      \"amount\": .50\n    }, {\n      \"name\": \"Bell pepper\",\n      \"category\": \"Veg\",\n      \"amount\": 1.00\n    }, {\n      \"name\": \"Mushrooms\",\n      \"category\": \"Veg\",\n      \"amount\": 1.20\n    }, {\n      \"name\": \"Pineapple\",\n      \"category\": \"Veg\",\n      \"amount\": .75\n    }, {\n      \"name\": \"Sausage\",\n      \"category\": \"Non Veg\",\n      \"amount\": 1.00\n    }, {\n      \"name\": \"Pepperoni\",\n      \"category\": \"Non Veg\",\n      \"amount\": 2.00\n    }, {\n      \"name\": \"Chicken\",\n      \"category\": \"Non Veg\",\n      \"amount\": 3.00\n    }];\n    this.Sizes = [{\n      \"Name\": \"Small\",\n      \"Amount\": 5.00\n    }, {\n      \"Name\": \"Medium\",\n      \"Amount\": 7.00\n    }, {\n      \"Name\": \"Large\",\n      \"Amount\": 8.00\n    }, {\n      \"Name\": \"Extra Large\",\n      \"Amount\": 9.00\n    }];\n    this.offers = [{\n      \"type\": 'fixed',\n      \"value\": 5,\n      \"criteria\": {\n        toppingQty: 2,\n        size: 'Medium',\n        Qty: 1\n      },\n      \"name\": \"Offer 1\"\n    }, {\n      \"type\": 'fixed',\n      \"value\": 9,\n      \"criteria\": {\n        toppingQty: 4,\n        size: 'Medium',\n        Qty: 2\n      },\n      \"name\": \"Offer 1\"\n    }, {\n      \"type\": 'percent',\n      \"value\": 50,\n      \"criteria\": {\n        toppingQty: 4,\n        size: 'Medium',\n        Qty: 1\n      },\n      \"name\": \"Offer 1\"\n    }];\n    this.carts = [];\n    this.total = 0;\n    this.gorups = _.groupBy(this.Toppings.reverse(), \"category\");\n    console.log(this.gorups);\n  }\n  getToppings(name) {\n    return _.filter(this.Toppings, {\n      category: name\n    });\n  }\n  addCart(s) {\n    var _dccc = document.querySelectorAll(`[data-size='${s.Name}']`);\n    var _toppings = [];\n    _dccc.forEach(e => {\n      if (e instanceof HTMLInputElement) {\n        if (e.checked) {\n          _toppings.push(e.dataset.topping);\n        }\n      }\n    });\n    if (_toppings.length == 0) {\n      alert(\"At-least one topping requried\");\n      return;\n    }\n    var _items = {\n      Toppings: _toppings,\n      Qty: 1,\n      Size: s.Name\n    };\n    _items.Amount = 0;\n    _items.Amount = _items.Amount + _.chain(this.Toppings).filter(e => {\n      return _toppings.indexOf(e.name) !== -1;\n    }).sumBy('amount').value();\n    _items.Amount = _items.Amount + s.Amount;\n    // Apply offers\n    this.offers.forEach(offer => {\n      const criteria = offer.criteria;\n      const matchingItems = this.carts.filter(item => item.Toppings.length >= criteria.toppingQty && item.Size === criteria.size && item.Qty >= criteria.Qty);\n      console.log(matchingItems);\n      if (matchingItems.length > 0) {\n        matchingItems.forEach(item => {\n          if (offer.type === 'fixed') {\n            item.OriginalPrice = item.Amount;\n            item.Amount -= offer.value;\n          } else if (offer.type === 'percent') {\n            item.OriginalPrice = item.Amount;\n            const discount = offer.value / 100 * item.Amount;\n            item.Amount -= discount;\n          }\n        });\n      }\n    });\n    this.carts.push(_items);\n    this.calcTotal();\n    this.clear(s);\n  }\n  clear(s) {\n    var _dccc = document.querySelectorAll(`[data-size='${s.Name}']`);\n    _dccc.forEach(e => {\n      if (e instanceof HTMLInputElement) {\n        e.checked = false;\n      }\n    });\n  }\n  calcTotal() {\n    this.total = _.sumBy(this.carts, 'Amount');\n  }\n  removeItem(index) {\n    this.carts.splice(index, 1);\n    this.calcTotal();\n  }\n}\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)();\n};\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  decls: 24,\n  vars: 8,\n  consts: [[1, \"row\"], [1, \"col-8\"], [1, \"table\", \"table-bordered\"], [1, \"\"], [\"rowspan\", \"2\", 1, \"text-center\", \"align-middle\", \"bg-light\", 2, \"vertical-align\", \"middle\"], [1, \"text-center\", \"bg-light\"], [\"class\", \"text-center bg-light\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-4\"], [\"class\", \"table table-bordered\", 4, \"ngIf\"], [\"class\", \"p-3 bg-light border text-center\", 4, \"ngIf\"], [1, \"bg-light\"], [1, \"text-center\"], [1, \"form-check\", \"d-inline-block\"], [\"type\", \"checkbox\", 1, \"form-check-input\", 3, \"id\"], [1, \"form-check-label\", 3, \"for\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"bg-light\", 2, \"width\", \"50px\"], [1, \"bg-light\", 2, \"width\", \"100px\"], [\"style\", \"font-size: 14px;\", 4, \"ngFor\", \"ngForOf\"], [\"colspan\", \"2\", 1, \"text-end\", \"fw-bold\", \"bg-light\"], [1, \"bg-light\", \"fw-bold\"], [2, \"font-size\", \"14px\"], [1, \"mb-0\"], [\"href\", \"javascript:void(0)\", 1, \"text-danger\", 3, \"click\"], [1, \"p-3\", \"bg-light\", \"border\", \"text-center\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h3\");\n      i0.ɵɵtext(3, \"Order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"table\", 2)(5, \"thead\", 3)(6, \"tr\")(7, \"th\", 4);\n      i0.ɵɵtext(8, \" Toppings \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"th\", 5);\n      i0.ɵɵtext(10, \" Pizza size \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"tr\");\n      i0.ɵɵtemplate(12, HomeComponent_th_12_Template, 2, 2, \"th\", 6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"tbody\");\n      i0.ɵɵtemplate(14, HomeComponent_ng_container_14_Template, 5, 3, \"ng-container\", 7);\n      i0.ɵɵpipe(15, \"keyvalue\");\n      i0.ɵɵelementStart(16, \"tr\");\n      i0.ɵɵelement(17, \"td\");\n      i0.ɵɵtemplate(18, HomeComponent_th_18_Template, 3, 0, \"th\", 8);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(19, \"div\", 9)(20, \"h3\");\n      i0.ɵɵtext(21, \"Cart\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(22, HomeComponent_table_22_Template, 16, 2, \"table\", 10);\n      i0.ɵɵtemplate(23, HomeComponent_div_23_Template, 3, 0, \"div\", 11);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵattribute(\"colspan\", ctx.Sizes.length);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.Sizes);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(15, 6, ctx.gorups));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.Sizes);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.carts.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.carts.length == 0);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i1.KeyValuePipe],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["_","i0","HomeComponent","constructor","toppingQty","size","Qty","gorups","groupBy","Toppings","reverse","console","log","getToppings","name","filter","category","addCart","s","_dccc","document","querySelectorAll","Name","_toppings","forEach","e","HTMLInputElement","checked","push","dataset","topping","length","alert","_items","Size","Amount","chain","indexOf","sumBy","value","offers","offer","criteria","matchingItems","carts","item","type","OriginalPrice","discount","calcTotal","clear","total","removeItem","index","splice","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\work\\sriramsadineni\\pizza-delivery-codetest\\pizzadelivery\\PizzaDelivery\\ClientApp\\src\\app\\home\\home.component.ts","C:\\work\\sriramsadineni\\pizza-delivery-codetest\\pizzadelivery\\PizzaDelivery\\ClientApp\\src\\app\\home\\home.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport * as _ from 'lodash';\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: './home.component.html',\r\n})\r\nexport class HomeComponent {\r\n\r\n  Toppings = [{\r\n    \"name\": \"Tomatoes\",\r\n    \"category\": \"Veg\",\r\n    \"amount\": 1.00,\r\n  }, {\r\n    \"name\": \"Onions\",\r\n    \"category\": \"Veg\",\r\n    \"amount\": .50,\r\n  },\r\n  {\r\n    \"name\": \"Bell pepper\",\r\n    \"category\": \"Veg\",\r\n    \"amount\": 1.00,\r\n  },\r\n  {\r\n    \"name\": \"Mushrooms\",\r\n    \"category\": \"Veg\",\r\n    \"amount\": 1.20,\r\n  },\r\n  {\r\n    \"name\": \"Pineapple\",\r\n    \"category\": \"Veg\",\r\n    \"amount\": .75,\r\n  },\r\n  {\r\n    \"name\": \"Sausage\",\r\n    \"category\": \"Non Veg\",\r\n    \"amount\": 1.00,\r\n  },\r\n  {\r\n    \"name\": \"Pepperoni\",\r\n    \"category\": \"Non Veg\",\r\n    \"amount\": 2.00,\r\n  },\r\n  {\r\n    \"name\": \"Chicken\",\r\n    \"category\": \"Non Veg\",\r\n    \"amount\": 3.00,\r\n  }]\r\n\r\n  Sizes = [{\r\n    \"Name\": \"Small\",\r\n    \"Amount\": 5.00\r\n  },\r\n  {\r\n    \"Name\": \"Medium\",\r\n    \"Amount\": 7.00\r\n  },\r\n  {\r\n    \"Name\": \"Large\",\r\n    \"Amount\": 8.00\r\n  },\r\n  {\r\n    \"Name\": \"Extra Large\",\r\n    \"Amount\": 9.00\r\n  }]\r\n  offers = [{\r\n    \"type\" : 'fixed',\r\n    \"value\" : 5,\r\n    \"criteria\" : {\r\n      toppingQty : 2,\r\n      size : 'Medium',\r\n      Qty : 1\r\n      \r\n    },\r\n    \"name\" : \"Offer 1\"\r\n  },\r\n  {\r\n    \"type\" : 'fixed',\r\n    \"value\" : 9,\r\n    \"criteria\" : {\r\n      toppingQty : 4,\r\n      size : 'Medium',\r\n      Qty : 2,\r\n      \r\n    },\r\n    \"name\" : \"Offer 1\"\r\n  },\r\n  {\r\n    \"type\" : 'percent',\r\n    \"value\" : 50,\r\n    \"criteria\" : {\r\n      toppingQty : 4,\r\n      size : 'Medium',\r\n      Qty : 1,\r\n      \r\n    },\r\n    \"name\" : \"Offer 1\"\r\n  }]\r\n  carts: any[] = []\r\n  gorups: any;\r\n  constructor() {\r\n\r\n    this.gorups = _.groupBy(this.Toppings.reverse(), \"category\");\r\n    console.log(this.gorups)\r\n  }\r\n\r\n  getToppings(name: any) {\r\n\r\n    return _.filter(this.Toppings, { category: name })\r\n  }\r\n  addCart(s: any) {\r\n\r\n    var _dccc = document.querySelectorAll(`[data-size='${s.Name}']`)\r\n    var _toppings: any[] = [];\r\n    _dccc.forEach(e => {\r\n      if (e instanceof HTMLInputElement) {\r\n        if (e.checked) {\r\n          _toppings.push(e.dataset.topping)\r\n        }\r\n      }\r\n    })\r\n\r\n    if(_toppings.length == 0)\r\n    {\r\n      alert(\"At-least one topping requried\")\r\n      return;\r\n    }\r\n    var _items: any = {\r\n      Toppings: _toppings,\r\n      Qty: 1,\r\n      Size: s.Name\r\n    }\r\n    _items.Amount = 0;\r\n    _items.Amount = _items.Amount + _.chain(this.Toppings).filter(e => {\r\n      return _toppings.indexOf(e.name) !== -1\r\n    }).sumBy('amount').value();\r\n\r\n    _items.Amount = _items.Amount + s.Amount;\r\n\r\n  // Apply offers\r\n    this.offers.forEach(offer => {\r\n      const criteria = offer.criteria;\r\n      const matchingItems = this.carts.filter(item =>\r\n        item.Toppings.length >= criteria.toppingQty &&\r\n        item.Size === criteria.size &&\r\n        item.Qty >= criteria.Qty\r\n      );\r\n      console.log(matchingItems)\r\n      if (matchingItems.length > 0) {\r\n        matchingItems.forEach(item => {\r\n          if (offer.type === 'fixed') {\r\n            item.OriginalPrice = item.Amount;\r\n            item.Amount -= offer.value;\r\n          } else if (offer.type === 'percent') {\r\n            item.OriginalPrice = item.Amount;\r\n            const discount = (offer.value / 100) * item.Amount;\r\n            item.Amount -= discount;\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    this.carts.push(_items);\r\n\r\n    this.calcTotal();\r\n    this.clear(s);\r\n  }\r\n  clear(s:any){\r\n    var _dccc = document.querySelectorAll(`[data-size='${s.Name}']`)\r\n    _dccc.forEach(e => {\r\n      if (e instanceof HTMLInputElement) {\r\n        e.checked = false;\r\n      }\r\n    })\r\n  }\r\n  total = 0;\r\n  calcTotal(){\r\n    this.total = _.sumBy(this.carts, 'Amount');\r\n  }\r\n\r\n  removeItem(index: number) {\r\n    this.carts.splice(index, 1);\r\n    this.calcTotal();\r\n  }\r\n\r\n  \r\n}\r\n\r\n\r\n","<div class=\"row\">\r\n  <div class=\"col-8\">\r\n    <h3>Order</h3>\r\n    <table class=\"table table-bordered\">\r\n      <thead class=\"\">\r\n        <tr>\r\n          <th rowspan=\"2\" class=\"text-center align-middle bg-light\" style=\"vertical-align: middle;\">\r\n            Toppings\r\n          </th>\r\n          <th [attr.colspan]=\"Sizes.length\" class=\"text-center bg-light\">\r\n            Pizza size\r\n          </th>\r\n        </tr>\r\n        <tr>\r\n          <th *ngFor=\"let s of Sizes\" class=\"text-center bg-light\">\r\n            {{ s.Name }} (${{ s.Amount }})\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <ng-container *ngFor=\"let s of gorups | keyvalue\">\r\n          <tr>\r\n            <th class=\"bg-light\" [attr.colspan]=\"1 + Sizes.length\">\r\n              {{ s.key }}\r\n            </th>\r\n          </tr>\r\n          <tr *ngFor=\"let v of getToppings(s.key)\">\r\n            <th class=\"text-center\">{{ v.name }} (${{ v.amount }})</th>\r\n            <th *ngFor=\"let s of Sizes\" class=\"text-center\">\r\n              <div class=\"form-check d-inline-block\">\r\n                <input\r\n                  class=\"form-check-input\"\r\n                  [attr.data-topping]=\"v.name\"\r\n                  [attr.data-size]=\"s.Name\"\r\n                  type=\"checkbox\"\r\n                  id=\"{{\r\n                    v.name.replace(' ', '-') + '-' + s.Name.replace(' ', '-')\r\n                  }}\"\r\n                />\r\n                <label\r\n                  class=\"form-check-label\"\r\n                  for=\"{{\r\n                    v.name.replace(' ', '-') + '-' + s.Name.replace(' ', '-')\r\n                  }}\"\r\n                >\r\n                </label>\r\n              </div>\r\n            </th>\r\n          </tr>\r\n        </ng-container>\r\n        <tr>\r\n          <td></td>\r\n          <th *ngFor=\"let s of Sizes\" class=\"text-center\">\r\n            <button class=\"btn btn-primary\" (click)=\"addCart(s)\">Add Cart</button>\r\n          </th>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  \r\n  <div class=\"col-4\">\r\n    <h3>Cart</h3>\r\n    <table class=\"table table-bordered\" *ngIf=\"carts.length > 0\">\r\n      <thead class=\"\">\r\n        <tr>\r\n          <th class=\"bg-light\">Description</th>\r\n          <th class=\"bg-light\" style=\"width: 50px\">Qty</th>\r\n          <th class=\"bg-light \" style=\"width: 100px\"> Price</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr *ngFor=\"let c of carts; let i = index\"  style=\"font-size: 14px;\">\r\n          \r\n          <td>\r\n            <p class=\"mb-0\">Size : {{ c.Size }}</p>\r\n            <p class=\"mb-0\">Toppings : {{ c.Toppings.join(\", \") }}</p>\r\n            <a\r\n              class=\"text-danger\"\r\n              href=\"javascript:void(0)\"\r\n              (click)=\"removeItem(i)\"\r\n            >\r\n              remove\r\n            </a>\r\n          </td>\r\n          <td>\r\n            {{ c.Qty }}\r\n          </td>\r\n          <td>\r\n            {{ c.Amount }}\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td colspan=\"2\" class=\"text-end fw-bold bg-light\">Total</td>\r\n          <td class=\"bg-light fw-bold\">${{ total }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <div class=\"p-3 bg-light border text-center\" *ngIf=\"carts.length == 0\">\r\n      <span>\r\n        Empty Cart\r\n      </span>\r\n    </div>\r\n  </div>\r\n  \r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}